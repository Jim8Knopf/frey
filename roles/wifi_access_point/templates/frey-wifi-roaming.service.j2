[Unit]
Description=Frey WiFi Automatic Roaming Service
Documentation=file:///opt/frey/docs/WIFI_ROAMING.md
After=network.target wpa_supplicant.service dhcpcd.service
Wants=network.target
# Start after WiFi AP is up (if enabled)
After=hostapd.service dnsmasq.service

[Service]
Type=simple
ExecStart=/usr/local/bin/frey-wifi-roaming-daemon --foreground
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal
SyslogIdentifier=frey-wifi-roaming

# Security hardening
NoNewPrivileges=false
PrivateTmp=yes
ProtectSystem=strict
ProtectHome=yes
ReadWritePaths=/var/log /var/lib/frey /var/run /etc/frey

# Allow network configuration
AmbientCapabilities=CAP_NET_ADMIN CAP_NET_RAW
CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_RAW

# Resource limits
MemoryLimit=100M
CPUQuota=25%

# Environment
Environment="PATH=/usr/local/bin:/usr/bin:/bin"

[Install]
WantedBy=multi-user.target
