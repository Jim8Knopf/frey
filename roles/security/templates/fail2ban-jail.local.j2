# Fail2ban local jail configuration
# Managed by Ansible - DO NOT EDIT MANUALLY
#
# This configuration ensures that trusted devices (your laptop, phone, etc.)
# are NEVER banned by fail2ban, regardless of failed login attempts.

[DEFAULT]
# Whitelist trusted IP addresses and networks
# These IPs will NEVER be banned by fail2ban
ignoreip = 127.0.0.1/8 ::1 {% for network in network_security.trusted_networks %}{{ network }} {% endfor %}{{ network_security.trusted_device_ips | default([]) | join(' ') }}

# Ban settings - more lenient for home use
bantime  = 10m
findtime  = 10m
maxretry = 10

# Email notifications (disabled by default)
destemail = root@localhost
sendername = Fail2Ban
mta = sendmail

# Action: ban only (no email notifications)
action = %(action_)s

[sshd]
# SSH jail - protects against brute force attacks
enabled = true
port = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s
maxretry = 10
findtime = 10m
bantime = 1h

# Additional whitelist for SSH (belt and suspenders approach)
ignoreip = 127.0.0.1/8 ::1 {% for network in network_security.trusted_networks %}{{ network }} {% endfor %}{{ network_security.trusted_device_ips | default([]) | join(' ') }}
