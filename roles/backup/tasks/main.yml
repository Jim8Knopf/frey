---
# ==============================================================================
# BACKUP - AUTOMATED BACKUP SYSTEM
# ==============================================================================
# Provides automated backups of application data and configurations

- name: Deploy backup script
  ansible.builtin.template:
    src: backup.sh.j2
    dest: /usr/local/bin/backup.sh
    owner: root
    group: root
    mode: '0755'
  when: backup.enabled | default(false)

- name: Schedule daily backup cron job
  ansible.builtin.cron:
    name: "Daily Application Backup"
    minute: "{{ backup.schedule.minute | default('0') }}"
    hour: "{{ backup.schedule.hour | default('3') }}"
    job: "/usr/local/bin/backup.sh > /dev/null 2>&1"
    state: present
  when: backup.enabled | default(false)
