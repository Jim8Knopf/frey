---
# Enhanced Raspberry Pi 5 Off-Grid Media & AI Hub Configuration
# Main language: English, German content support included

# ================================
# USER CONFIGURATION
# ================================
media_user: media
media_uid: 1000
media_gid: 1000

# ================================
# DOCKER CONFIGURATION
# ================================
docker_users: [ "{{ media_user }}" ]

# ================================
# STORAGE PATHS
# ================================
base_dir: /opt/frey
media_dir: "{{ base_dir }}/media"
appdata_dir: "{{ base_dir }}/appdata"
downloads_dir: "{{ base_dir }}/downloads"
photos_dir: "{{ base_dir }}/photos"
ai_dir: "{{ base_dir }}/ai"
backups_dir: "{{ base_dir }}/backups"
logs_dir: "{{ base_dir }}/logs"
stacks_dir: "{{ base_dir }}/stacks"  # For Dockge

# ================================
# NETWORK CONFIGURATION
# ================================
domain_name: frey
timezone: Australia/Hobart

# DNS Rewrites for AdGuard Home
# This will make services available at http://<service>.<domain_name>
dns_rewrites:
  - name: jellyfin
  - name: sonarr
  - name: radarr
  - name: readarr
  - name: bazarr
  - name: audiobookshelf
  - name: qbittorrent
  - name: prowlarr
  - name: dockge
  - name: portainer
  - name: grafana
  - name: uptime-kuma
  - name: traefik
  - name: immich
  - name: cookbook
  - name: jellyseerr
  - name: lidarr
  - name: jellystat

# ================================
# SERVICE PORTS
# ================================
# Media Stack
jellyfin_port: 8096
sonarr_port: 8989
radarr_port: 7878
readarr_port: 8787
qbittorrent_port: 8080
prowlarr_port: 9696
audiobookshelf_port: 13378
bazarr_port: 6767
jellyseerr_port: 5055
lidarr_port: 8686
jellystat_port: 8086

# AI Stack
ollama_port: 11434
openwebui_port: 3000

# Photos & Home
immich_port: 2283
homeassistant_port: 8123

# Infrastructure
traefik_port: 80
traefik_dashboard_port: 8081
portainer_port: 9000
dockge_port: 5001

# Monitoring
grafana_port: 3001
prometheus_port: 9090
node_exporter_port: 9100
cadvisor_port: 8082
loki_port: 3100
promtail_port: 9080
uptime_kuma_port: 3002

# File Management
filebrowser_port: 8083
code_server_port: 8084

# Network Tools
speedtest_port: 8085
adguardhome_port: 3053

# Cookbook
cookbook_port: 8090

# Voice Assistant
piper_port: 10200

# ================================
# SECURITY SETTINGS
# ================================
enable_fail2ban: true
enable_ufw: true
ssh_port: 22

# Dynamically generated list of TCP ports to open in the firewall based on feature toggles.
# This centralizes the logic and makes the security role cleaner.
firewall_tcp_ports: "{{
  [ssh_port, dockge_port] +
  (deploy_infrastructure | ternary([traefik_port, traefik_dashboard_port, portainer_port], [])) +
  (deploy_media_stack | ternary([jellyfin_port, sonarr_port, radarr_port, readarr_port, bazarr_port, audiobookshelf_port, qbittorrent_port, prowlarr_port, jellyseerr_port, lidarr_port, jellystat_port], [])) +
  (deploy_ai_stack | ternary([ollama_port, openwebui_port], [])) +
  (deploy_photo_management | ternary([immich_port], [])) +
  (deploy_homeassistant | ternary([homeassistant_port], [])) +
  (deploy_monitoring | ternary([grafana_port, prometheus_port, uptime_kuma_port], [])) +
  (deploy_networking | ternary([adguardhome_port, speedtest_port], [])) +
  (deploy_file_management | ternary([filebrowser_port, code_server_port], [])) +
  (deploy_cookbook | ternary([cookbook_port], [])) +
  (deploy_piper | ternary([piper_port], []))
  }}"


# ================================
# OPTIMIZATION SETTINGS
# ================================
# SSD Optimization
enable_ssd_optimization: false
enable_trim: true

# German Content Support
german_locale: de_DE.UTF-8
enable_german_indexers: true

# ================================
# POWER MANAGEMENT (12V setup)
# ================================
enable_power_monitoring: true
low_power_threshold: 11.8  # Volts
critical_power_threshold: 11.0  # Volts
enable_graceful_shutdown: true

# ================================
# AUTOMATION SETTINGS
# ================================
watchtower_interval: 86400  # 24 hours
backup_retention_days: 7

# ================================
# FEATURE TOGGLES
# ================================
# Services to deploy (set to false to skip)
deploy_media_stack: true
deploy_ai_stack: false
deploy_photo_management: true
deploy_homeassistant: false
deploy_monitoring: false
deploy_networking: false
deploy_file_management: false
deploy_backup: false
deploy_infrastructure: false
deploy_piper: false
deploy_cookbook: false

# ================================
# VOICE ASSISTANT
# ================================
deploy_voice_assistant: false
voice_assistant_wake_word: "frey"          # e.g., "computer", "alexa", "jarvis"
porcupine_access_key: "YOUR_PICOVOICE_ACCESS_KEY" # Get a free key from https://console.picovoice.ai/
voice_assistant_ollama_model: "llama3:latest"  # The Ollama model to use
# The default voice the assistant should use for responses. Must be one of the voices loaded below.
voice_assistant_piper_voice: "en_US-lessac-medium"
# List of voices to load into the Piper TTS service.
# Find more here: https://rhasspy.github.io/piper-samples/
piper_voices:
  - "en_US-lessac-medium"   # US English
  - "en_AU-southern-female" # Australian English
  - "de_DE-thorsten-medium" # German